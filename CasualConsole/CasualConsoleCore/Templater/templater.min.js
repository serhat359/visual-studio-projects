let Templater=function(){function e(){throw Error()}function t(t,i){i==t.length&&e();let o=t.indexOf("{{",i);if(o==i){let[s,g]=r(t,o+2),c=s[0];if("if"===c){let h=u(s,1),p;[p,g]=f(t,g);let a=l(t,g);if("else"!==a){let _=(e,t)=>{h(t)&&n(e,t,p)};return[_,g]}let $=[],b=null,d;for(;;){if([d,g]=r(t,g+2),1==d.length){[b,g]=f(t,g);break}{"if"!==d[1]&&e();let m=u(d,2),w;[w,g]=f(t,g),$.push([m,w])}if("else"!==(a=l(t,g)))break}let x=(e,t)=>{if(h(t)){n(e,t,p);return}for(let[r,l]of $)if(r(t)){n(e,t,l);return}if(b){n(e,t,b);return}};return[x,g]}if("for"===c){let y=s[2];if("in"!==y&&"range"!==y){let j=s.findIndex(e=>"in"===e||"range"===e);j>2?y=(s=function e(t,n){let r=t.slice(1,n).join("");return[t[0],r,...t.slice(n)]}(s,j))[2]:e()}let[k,v]=s[1].split(","),T=u(s,3),E;[E,g]=f(t,g);let I="in"===y?(e,t)=>{let r=T(t),l=0;for(let f of r)t.set(k,f),v&&t.set(v,l),n(e,t,E),l++}:(e,t)=>{let r=T(t);for(let l in r)t.set(k,l),t.set(v,r[l]),n(e,t,E)};return[I,g]}if("end"===c||"else"===c)return[null,g];else if("set"===c){let O=s[1],q=u(s,2),z=(e,t)=>t.set(O,q(t));return[z,g]}else{let A=u(s,0),B=(e,t)=>{var n;return e((n=String((n=A(t))??""),/[&<>\'\"]/.test(n)?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;"):n))};return[B,g]}}return o<0?[t.substring(i),t.length]:[t.substring(i,o),o]}function n(e,t,n){for(let r of n)"string"==typeof r?e(r):r(e,t)}function r(e,t){let n=[];for(;;){for(;" "===e[t];)t++;if("}"===e[t]&&"}"===e[t+1])return[n,t+2];let r=t++;for(;t<e.length&&"}"!==e[t]&&" "!==e[t];)t++;let l=e.substring(r,t);s(l),n.push(l)}}function l(e,t){for(;t<e.length&&/\s/.test(e[t]);)t++;if(t+1<e.length&&"{"===e[t]&&"{"===e[t+1]){for(t+=2;" "===e[t];)t++;let n=t++;for(;t<e.length&&"}"!==e[t]&&" "!==e[t];)t++;return e.substring(n,t)}return null}function f(e,n){let r=[],l;for(;[l,n]=t(e,n),l;)r.push(l);return[r,n]}function u(t,n){if((t.length-n==0||"."===t[n])&&e(),t.length-n==1)return o(t[n]);let r=t[n];r.includes(".")&&e();let l=function e(t,n){let r=[];for(;n<t.length;)r.push(o(t[n++]));return r}(t,n+1);if(1==l.length){let f=l[0];return e=>{let t=i(r,e);return t(f(e))}}return e=>{let t=i(r,e),n=l.map(t=>t(e));return t.apply(null,n)}}function i(e,t){let n=t.get(e);if("function"!=typeof n)throw Error(`value of ${e} was not a function`);return n}function o(t){let n=t.split(".");if(n.forEach(s),1==n.length){let r=n[0];return e=>e.get(r)}if(2==n.length){let l=n[0],f=n[1];return e=>e.get(l)[f]}if(3==n.length){let u=n[0],i=n[1],o=n[2];return e=>e.get(u)[i][o]}e()}function s(t){t||e()}return{compile:function e(r){let l=[],f=0,u;for(;f<r.length;)[u,f]=t(r,f),s(u),l.push(u);return(e,t)=>{t??={};let r=[],f=e=>r.push(e),u={};return u.$=e,n(f,{get:n=>u[n]??t[n]??e[n],set(e,t){u[e]=t}},l),r.join("")}}}}();